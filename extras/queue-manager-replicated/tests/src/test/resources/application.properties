# Select our ReplicatedQueueManager as the active implementation
quarkus.arc.selected-alternatives=io.a2a.extras.queuemanager.replicated.core.ReplicatedQueueManager,io.a2a.extras.taskstore.database.jpa.JpaDatabaseTaskStore

# Configure in-memory H2 database for testing
quarkus.datasource."a2a-java".db-kind=h2
quarkus.datasource."a2a-java".jdbc.url=jdbc:h2:mem:test
quarkus.hibernate-orm."a2a-java".datasource=a2a-java
quarkus.hibernate-orm."a2a-java".database.generation=drop-and-create
quarkus.hibernate-orm."a2a-java".packages=io.a2a.extras.taskstore.database.jpa

# Configure the outgoing channel (QueueManager -> Kafka)
mp.messaging.outgoing.replicated-events-out.connector=smallrye-kafka
mp.messaging.outgoing.replicated-events-out.topic=replicated-events
mp.messaging.outgoing.replicated-events-out.value.serializer=org.apache.kafka.common.serialization.StringSerializer

# Configure the incoming channel (Kafka -> QueueManager)
mp.messaging.incoming.replicated-events-in.connector=smallrye-kafka
mp.messaging.incoming.replicated-events-in.topic=replicated-events
mp.messaging.incoming.replicated-events-in.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer

# Dev Services for Kafka will automatically start a broker for us
quarkus.kafka.devservices.enabled=true

# Enhanced configuration for faster and more reliable tests
quarkus.kafka.devservices.topic-partitions."replicated-events"=1
mp.messaging.incoming.replicated-events-in.auto.offset.reset=earliest

# Test consumer channel - uses same topic but different consumer group
mp.messaging.incoming.test-replicated-events-in.connector=smallrye-kafka
mp.messaging.incoming.test-replicated-events-in.topic=replicated-events
mp.messaging.incoming.test-replicated-events-in.auto.offset.reset=earliest
mp.messaging.incoming.test-replicated-events-in.group.id=test-consumer-group

# Reduce timeouts for faster tests
quarkus.messaging.kafka.health.timeout=5s

# Enable debug logging for queue lifecycle and Kafka
quarkus.log.category."io.a2a.server.events".level=DEBUG
quarkus.log.category."io.a2a.server.requesthandlers".level=DEBUG
quarkus.log.category."io.a2a.extras.queuemanager.replicated".level=DEBUG
quarkus.log.category."io.a2a.client".level=DEBUG
quarkus.log.category."io.smallrye.reactive.messaging".level=DEBUG

